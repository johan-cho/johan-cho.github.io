<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="upgrade-insecure-requests"
    />
    <meta
      name="keywords"
      content="johan cho, johan, cho, northeastern, industrial engineering, data science, data, science, portfolio, projects, mbtamapper, mbta, mapper, mbta mapper, mbta map, mbta map generator, mbta map maker, mbta map creator, mbta map builder, mbta map builder, mbta map editor, mbta map editor, mbta map designer, mbta map designer, mbta map generator, mbta map generator, mbta map maker, mbta map maker, mbta map creator, mbta map creator, mbta map builder, mbta map builder, mbta map editor, mbta map editor, mbta map designer, mbta map designer, mbta map generator, mbta map generator, mbta map maker, mbta map maker, mbta map creator, mbta map creator, mbta map builder, mbta map builder, mbta map editor, mbta map editor, mbta map designer, mbta map designer, mbta map generator, mbta map generator, mbta map maker, mbta map maker, mbta map creator, mbta map creator, mbta map builder, mbta map builder, mbta map editor, mbta map editor, mbta map designer, mbta map designer"
    />
    <meta name="author" content="Johan Cho" />
    <link
      rel="canonical"
      href="https://johan-cho.github.io/etc/update-drivers"
    />

    <meta name="description" content="johan cho's other projects" />
    <link rel="icon" href="/src/img/lucario.ico" type="image/x-icon" />
    <title>Update Drivers | Johan Cho</title>

    <meta
      property="og:url"
      content="https://johan-cho.github.io/etc/update-drivers"
    />
    <meta property="og:image" content="/src/img/lucario.jpg" />
    <meta property="og:description" content="my portfolio" />
    <meta property="og:title" content="Extras | Johan Cho" />
    <!-- <meta property="og:site_name" content="johan cho's portfolio" /> -->
    <meta property="og:see_also" content="https://johan-cho.github.io/etc" />

    <link rel="stylesheet" href="/src/css/index.css" />
    <link rel="stylesheet" href="/src/css/projectcard.css" />
    <link rel="stylesheet" href="/src/css/navbar.css" />
    <link rel="stylesheet" href="/src/css/github-colors-text.css" />

    <script src="/src/js/index.js" async defer></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/night-owl.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- and it's easy to individually load additional languages -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/powershell.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css"
    />
    <script>
      hljs.addPlugin(new CopyButtonPlugin());
      hljs.highlightAll();
    </script>
  </head>
  <body>
    <nav class="nav">
      <div class="titleLogo"><a href="../index.html">johan cho</a></div>
      <input id="menu-toggle" type="checkbox" title="menutoggle" />
      <label class="menu-button-container" for="menu-toggle">
        <div class="menu-button"></div>
      </label>
      <ul class="menu" id="navmenu">
        <li id="modeToggle" class="fa"><a>&#xF186;</a></li>
        <li><a href="/about.html">about</a></li>
        <li><a href="/projects/index.html">projects</a></li>
        <li><a href="/etc/index.html">etc</a></li>
      </ul>
    </nav>
    <main class="body_container">
      <div>
        <h1 class="text-center">update drivers</h1>
        <h4 class="subheader text-center margin-top">
          via <span class="text-PowerShell">powershell</span>
        </h4>
      </div>
      <div>
        <p>
          This script updates drivers on windows, adopted from
          <a
            href="https://superuser.com/questions/1243011/how-to-automatically-update-all-devices-in-device-manager"
            target="_blank"
            rel="noopener"
            >this post</a
          >.
        </p>
        <pre><code class="code-font language-powershell">
function Update-Drivers([switch] $restart, [switch] $force) {
  <#
  .SYNOPSIS
      Updates drivers.
  .DESCRIPTION
      Updates drivers. For example, Update-Drivers updates drivers.
  .PARAMETER restart
      switch: Restarts the computer after updating.
  .PARAMETER force
      switch: Forces the update.
  .EXAMPLE
      Update-Drivers
  .OUTPUTS
      System.null
  #>

  try {
      $isAdmin = isadmin -ErrorAction Stop
  }
  catch {
      $isAdmin = ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
  }

  if ($force -and !($isAdmin)) {
      Admin "Update-Drivers"
      return
  }
  if (!($isAdmin)) {
      Write-Host('Please run this command as admin!') -Fore Red
      return
  }
  

  # you think i know what any of this shit does? lol

  $UpdateSvc = New-Object -ComObject Microsoft.Update.ServiceManager
  $UpdateSvc.AddService2("7971f918-a847-4430-9279-4a52d1efe18d", 7, "")
  $Session = New-Object -ComObject Microsoft.Update.Session
  $Searcher = $Session.CreateUpdateSearcher() 

  $Searcher.ServiceID = '7971f918-a847-4430-9279-4a52d1efe18d'
  $Searcher.SearchScope = 1 # MachineOnly
  $Searcher.ServerSelection = 3 # Third Party
        
  $Criteria = "IsInstalled=0 and Type='Driver'"
  Write-Host('Searching Driver-Updates...') -Fore Green     
  $SearchResult = $Searcher.Search($Criteria)          
  $Updates = $SearchResult.Updates
  if ([string]::IsNullOrEmpty($Updates)) {
      Write-Host "No pending driver updates."
      return
  }
  #Show available Drivers...
  $Updates | Select-Object Title, DriverModel, DriverVerDate, Driverclass, DriverManufacturer | Format-List
  $UpdatesToDownload = New-Object -Com Microsoft.Update.UpdateColl
  $updates | ForEach-Object { $UpdatesToDownload.Add($_) | out-null }
  Write-Host('Downloading Drivers...')  -Fore Green
  $UpdateSession = New-Object -Com Microsoft.Update.Session
  $Downloader = $UpdateSession.CreateUpdateDownloader()
  $Downloader.Updates = $UpdatesToDownload
  $Downloader.Download()
  $UpdatesToInstall = New-Object -Com Microsoft.Update.UpdateColl
  $updates | ForEach-Object { if ($_.IsDownloaded) { $UpdatesToInstall.Add($_) | out-null } }

  Write-Host('Installing Drivers...')  -Fore Green
  $Installer = $UpdateSession.CreateUpdateInstaller()
  $Installer.Updates = $UpdatesToInstall
  $InstallationResult = $Installer.Install()
  if ($InstallationResult.RebootRequired) { 
      Write-Host('Reboot required! Please reboot now.') -Fore Red
      if ($restart -or $force) {
          Restart-Computer
      }
  }
  else { Write-Host('Done.') -Fore Green }
  $updateSvc.Services | Where-Object { $_.IsDefaultAUService -eq $false -and $_.ServiceID -eq "7971f918-a847-4430-9279-4a52d1efe18d" } | ForEach-Object { $UpdateSvc.RemoveService($_.ServiceID) }
}

Update-Drivers        
        </code></pre>
        <!-- <img
          src="/src/img/WINGET_STUCK.png"
          class="centeredalt margin-top"
          title="album cover"
        /> -->
      </div>
    </main>
    <footer>
      <div>
        designed by me and hosted in
        <a
          href="https://github.com/johan-cho/johan-cho.github.io"
          rel="noopener"
          target="_blank"
          >this repo</a
        >.
      </div>
      <div class="fa links-wrapper">
        <a href="mailto:cho.joh@northeastern.edu" target="_blank" rel="noopener"
          >&#xf0e0;</a
        ><a
          href="https://www.linkedin.com/in/chojohan/"
          target="_blank"
          rel="noopener"
          >&#xf08c;</a
        ><a href="https://github.com/johan-cho" target="_blank" rel="noopener"
          >&#xf09b;</a
        ><a
          href="https://www.youtube.com/channel/UCP91LPgRFY03YoIGrmuMH9A"
          target="_blank"
          rel="noopener"
          >&#xf16a;</a
        ><a
          href="https://open.spotify.com/user/31rmddg3bkfj4gl56uvbw7225t3y?si=313276f3aff34fc2"
          target="_blank"
          rel="noopener"
          >&#xf1bc; </a
        ><a
          href="https://1drv.ms/b/s!AjJLCn3W5tpuiTgJ2ZnOaPpz-Nhu"
          target="_blank"
          rel="noopener"
          class="reduced-margin-left"
          >&#xf1c1;</a
        >
      </div>
    </footer>
  </body>
</html>
